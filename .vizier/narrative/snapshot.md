# Snapshot

- Product: CLI "annals" ingests GitHub histories and compresses them into readable logs spanning days, weeks, months, and years, with LLM summarization already available so users can turn commit windows into narrative diaries; default scope is account-level so a user can see a cross-repo diary without manual per-repo setup.
- Current surface — commit ingestion: CLI exposes `fetch-commits` (`src/main.rs`) that hits GitHub to gather commits for a login between a since/until window (RFC3339, date-only, or relative inputs), optionally filtering to a repo. It reads a PAT flag or `GITHUB_TOKEN`, lists repos based on auth (public-only when unauthenticated; owned/collab/org when the token matches the target login), dedupes and sorts commits (repo, sha, first-line message, timestamp, url, author/committer), and prints either human-readable lines or JSON; verbose mode shows pagination/progress, and auth/rate-limit errors bubble up with context. The command always reports how many repositories were discovered before scanning and prints a friendly notice when a window returns no commits.
- Current surface — narrative summaries: `summarize` (`src/main.rs`, `src/summarize.rs`) reuses the same query or a JSON file input to LLM-summarize commits. Users can override provider/model and pretty-printing; the command filters out "VIZIER CONVERSATION" commits, chunks large inputs to respect a configurable character budget while flagging truncation, fails fast when credentials are missing or all commits are filtered, and emits either human prose (with optional wrapping) or JSON that reports counts, truncation, and chunking stats; verbose mode surfaces context/chunk decisions.
- Current surface — library embedding: the crate exposes the fetch and summarize flows programmatically so other tools can drive them without the CLI, mirroring the flags (including base URL overrides) for testing against mocks or alternate endpoints.
- Current surface — progress telemetry: both commands (and the library via `EventSink`) can stream JSON events to stderr with `--events-json`, carrying structured payloads for dashboards/automation without touching stdout: normalized queries, repo discovery/pages, search fallbacks and per-repo scan starts/finishes with dedup counts, summary inputs/budgeting, chunk start/finish, compaction/truncation, and final summary stats.
- Active thread — gather commits for an account: Coverage now prefers GitHub’s commit search and falls back to paginated repo-by-repo scans when search is unavailable/incomplete/forbidden so we avoid missing days/weeks of work. Acceptance remains that, given a user plus window (and optional repo filter), annals returns the above commit fields and clearly reports auth/rate-limit/visibility issues to guide next steps.
- Upcoming: Aggregate fetched commits and summaries into rolling day/week/month/year diaries so users can read activity across time slices without manual window management.
